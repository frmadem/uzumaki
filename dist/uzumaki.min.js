// uzumaki - v0.0.1 (2015-07-19)
var uzumaki;!function(){"use strict";var a=function(){};uzumaki=new a,uzumaki.core=new a,exports.uzumaki=uzumaki}(),function(){uzumaki.core.ComponentUz=function(a,b){this.name=function(){return a},this.object=function(){return b},this.__state="READY",this.__callStack=[],this.__api={}};var a=uzumaki.core.ComponentUz.prototype;a.state=function(a){return void 0===a?this.__state:void(this.__state=a)},a.identify=function(){return"Actor '"+this.name()+"'"},a.stackCall=function(a){if(void 0===a)throw"uzumaki.core.ComponentUz.stackCall: call is undefined "+this.identify();this.__callStack.push(a)},a.callStack=function(){return this.__callStack},a.registerNewCall=function(a,b){if(void 0===a)throw"uzumaki.core.ComponentUz.registerNewCall: call is undefined "+this.identify();if(void 0===b||"function"!=typeof b)throw"uzumaki.core.ComponentUz.registerNewCall: code is undefined or not a function "+this.identify;this.__api[a]=b},a.message=function(a,b,c){if(void 0===this.__api[a])throw"uzumaki.core.ComponentUz: call not registered in "+this.identify()+": '"+a+"'";if("BUSY"===this.state())this.callStack([a,b,c]);else{var d=this.__api[a].apply(this.object(),b);if(!c)return d;c.call(c,d)}},a.describe=function(){return Object.keys(this.__api)}}(),function(){uzumaki.register=function(a,b){if("object"!=typeof b)throw"uzumaki.register: an object was expected";var c=b.__apiZ||[];uzumaki.__uzify(a,b),c.forEach(function(a){var c=b[a];b.__uz().registerNewCall(a,c)})},uzumaki.message=function(a){var b=a.split("."),c=Array.prototype.slice.call(arguments);return uzumaki.registry().message(b[0],b[1],c.slice(1,c.length))},uzumaki.messageAsync=function(a){var b=a.split("."),c=Array.prototype.slice.call(arguments),d=c.pop();return uzumaki.registry().message(b[0],b[1],c.slice(1,c.length),d)}}(),function(){function a(a,b,c){if(void 0!==a[b])throw"uzumaki.uzify.setPrototype: there is already a key '"+b+"' in the object";a[b]=c}uzumaki.__uzify=function(b,c){var d=new uzumaki.core.ComponentUz(b,c);a(c,"__uz",function(){return d}),a(c,"isActorZ",!0),a(c,"readyZ",function(){return this.__uz().state("READY")}.bind(c)),uzumaki.registry().register(b,c)}}(),function(){var a=!1,b=function(){this.__actors={},this.__blocked={}},c=b.prototype;c.actors=function(){return Object.keys(this.__actors)},c.actorObj=function(a){return this.__actors[a]},c.register=function(a,b){this.__actors[a]=b},c.block=function(a){this.__blocked[a]=!0},c.unblock=function(a){delete this.__blocked[a]},c.describe=function(a){return this.__actors[a].__uz().describe()},c.message=function(a,b,c,d){if(void 0===this.__actors[a])throw"uzumaki.core.Registry.message: message '"+b+"' to unregistered actor '"+a+"'";return this.__actors[a].__uz().message(b,c,d)},uzumaki.registry=function(){return a||(a=new b),a}}();