// uzumaki - v0.0.1 (2015-07-21)
function Message(a,b,c){this.name=a,this.args=b,this.callback=c}function Mailbox(){this.__stack=[]}function Actor(a,b){this.name=function(){return a},this.__onWork=!1,this.__initMailbox(),this.__initReceive(b)}function Registry(){this.__localActors={}}function registry(){}module.exports=Message;var Message=require("./message.js"),p=Mailbox.prototype;p.newMessage=function(a){this.__stack.push(a)},p.getMessage=function(){return this.__stack.shift()},module.exports=Mailbox;var Mailbox=require("./mailbox.js"),p=Actor.prototype;p.send=function(a){this.__mailbox.newMessage(a),setTimeout(function(){this.__work()}.bind(this),0)},p.__work=function(){if(this.__onWork!==!0){this.__onWork=!0;for(var a=!0;a;){var b=this.__mailbox.getMessage();b?this.__runMessage(b):a=!1}this.__onWork=!1}},p.__runMessage=function(a){var b=this.__api[a.name];b(a)},p.__initMailbox=function(){this.__mailbox=new Mailbox},p.__initReceive=function(a){if("object"!=typeof a)throw"uzumaki.Actor.new: receive is not an object";this.__api={};var b=Object.keys(a);b.forEach(function(b){var c=a[b];this.__api[b]=function(a){var b=c.apply(this,a.args);return a.callback?void a.callback(b):b}.bind(this)}.bind(this))},module.exports=Actor;var REGISTRY=!1;module.exports.registry=registry;